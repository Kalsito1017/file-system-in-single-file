# Файлова система върху единичен файл

Проектът представлява симулация на файлова система, реализирана върху един двоичен контейнерен файл. Всички файлове, директории и метаданни се съхраняват в един файл (.fsc), като системата поддържа пълна йерархия от директории, компресия, проверка на целостта и дефрагментация.

---

Структура на проекта:
FileSystemContainer/
├── FileSystemContainer.csproj    # Проектен файл
├── Program.cs                    # Основен потребителски интерфейс
├── FileSystemContainer.cs        # Основна логика на файловата система
├── BlockManager.cs               # Управление на блокове и памет
├── Compression.cs                # Компресия и декомпресия
├── Resiliency.cs                 # Проверка на целостта (checksum)
├── filesystem.fsc                # Примерен контейнерен файл (създава се автоматично)
└── README.md                     # Документация

Структура на контейнера:
0x0000: [MAGIC_STRING "FSCONTAINER"]   (12 байта)
0x000C: [Версия]                      (4 байта)
0x0010: [Брой записи]                 (4 байта)
0x0014: [Начало на метаданни]         (4 байта)
0x0018: [Резервирано]                 (12 байта)
0x0064: [Списък със свободни блокове] (променлив размер)
0x0800: [Метаданни]                   (променлив размер)
        [Данни на файловете]          (променлив размер)


 ## Метаданни (MetadataEntry)
Всеки запис за файл/директория съдържа:

ID и име

Parent ID (за йерархия на директории)

Отместване и размер на данните

Флагове (директория/файл, изтрит)

Контролна сума за целост

Компресиран размер

Време на създаване и промяна

##  Основна идея

Всички файлове и директории се съхраняват вътре в един файл (`.fsc`), който съдържа:

- хедър с информация за версията
- таблица с метаданни
- списък със свободни блокове
- реалните данни на файловете
- поддръжка на директории
- компресия и проверка за целостта

---

##  Поддържани команди

| Команда | Описание |
|------|----------|
| `cpin <външен_файл> <име>` | Копира файл в контейнера |
| `cpout <име> <външен_файл>` | Извлича файл от контейнера |
| `ls` | Показва съдържанието на текущата директория |
| `md <име>` | Създава директория |
| `rd <име>` | Изтрива директория |
| `cd <път>` | Смяна на директория |
| `rm <име>` | Изтрива файл |
| `defrag` | Дефрагментира контейнера |
| `info` | Информация за контейнера |
| `help` | Показва помощ |
| `exit` | Изход от програмата |

---

## Ключови компоненти:

# FileSystemContainer
Основният клас, който управлява:

Зареждане и създаване на контейнери

Файлови операции (четене, запис, изтриване)

Управление на директории

Взаимодействие с други компоненти

# BlockManager
Управлява паметта в контейнера:

Намира свободни блокове

Освобождава място след изтриване

# Дефрагментация

Поддържа списък със свободни блокове

Compression
Осигурява компресия на данните:

Автоматично избира между RLE и GZip в зависимост от размера

Декомпресиране при четене

Оптимизация на мястото

# Resiliency
Проверка на целостта:

Изчисляване на контролни суми

Проверка при четене и запис

Откриване на повредени данни



## Инсталация и използване
# Предварителни изисквания
.NET 8.0 SDK или по-нова версия


## Стартиране:
# Компилиране
dotnet build

# Стартиране в интерактивен режим
dotnet run

# Или с конкретни команди
dotnet run -- cpin test.txt файл.txt
dotnet run -- ls
dotnet run -- info


## Примерна сесия:
# Създаване на тестови файлове
echo "Hello, World!" > hello.txt
echo "Test content" > test.txt

# Вътре в програмата:
fs> cpin hello.txt здравей.txt
fs> cpin test.txt тест.txt
fs> md документи
fs> cd документи
fs> cpin hello.txt файл_в_папка.txt
fs> ls
fs> cd ..
fs> cpout здравей.txt копие.txt
fs> info
fs> exit
